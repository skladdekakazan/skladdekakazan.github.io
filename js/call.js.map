{"version":3,"sources":["call.js"],"names":["getTimeRemaining","endtime","t","moskow","hours","minutes","key","obj","slice","d","Date","setTime","getTime","getTimezoneOffset","offset","dayEnd","setHours","querySelector","h","document","setInterval","textContent","result","m","s","seconds","getSale","localStorage","getItem","setSale","setItem","now","startTime","endTime","timer","resaultTime","salemodal","window","setTimeout","style","display","modalSaleClose","addEventListener","modalSaleCloseBtn","submitSaleCC","params","str","credentials","mode","method","fetch","headers","name","phone","catch","error","console","log","modalFormSaleCC","submitFormSaleCC","e","value","alert"],"mappings":"aAAA,SAASA,iBAAiBC,GACxB,IAAMC,EAAID,EAAUE,SAAdD,EAAID,CAGRG,MAAAF,EAAA,KAAA,GAAA,EACAE,QAAQF,EAAI,IAAO,GAAK,GAAM,EAC9BG,QAASH,EAAI,IAAO,GAAK,GAI3B,IAAK,IAAII,KAAOC,EAAhBA,EAAKD,IAAL,IAAAC,EAAAD,IAAAE,OAAA,GACED,OAAGA,EACH,SAAOA,SACV,IAIKE,EAAI,IAAIC,KADZ,OADFD,EAAAE,SAASR,IAATO,MAAmBE,UAAA,GAAAH,EAAAI,oBAAA,IAAA,OACXC,EAGN,IAAAC,OAAAZ,SACDY,OAAAC,SAAA,GAAA,GAAA,GAAA,KAED,IAAMD,EAAAA,SAASZ,cAAf,WACAY,EAAOC,SAASC,cAAhB,WAEIC,EAAIC,SAASF,cAAc,WAE/BG,YAAQD,WAERC,IAAAA,EAAYpB,iBAAMe,QAGhBG,EAAEG,YAAcC,EAAOlB,MACvBmB,EAAEF,YAAcC,EAAOjB,QACvBmB,EAAEH,YAAcC,EAAOG,SACtB,KAEH,IAAMC,QAAU,WACd,OAAOC,aAAaC,QAAQ,SAGxBC,QAAU,WACdF,aAAaG,QAAQ,OAAQpB,KAAKqB,QAGhCC,UAAYN,UACZO,QAAUvB,KAAKqB,MACfG,MAAQ,IACRC,YAAsCD,MAAvBD,QAAUD,WAEb,MAAbN,WAAqBS,cAAxBN,UAIA,IAAIO,UAAYjB,SAASF,cAAc,cAAdA,KAAzBoB,OAAID,OAAYjB,YAAAgB,aAGdG,WAAW,WAAQF,UAAUG,MAAMC,QAAU,SAAY,KAAtCJ,IAAAA,eAAgBI,SAAUvB,cAA1B,yBAAoCwB,eAAvDC,iBAAA,QAAA,WAAAN,UAAAG,MAAAC,QAAA,SAMF,IAAIG,kBAAoBxB,SAASF,cAAc,4BAFqC,SAApF2B,aAAAC,GAEA,IAAIF,EAAAA,OAAAA,KAAoBxB,oHAC4BiB,MAAAA,GAAAA,OAASU,GAAON,CAEpEO,YAAA,cAMIC,KAAK,UALTC,OAASL,OAGPM,QAAK,CACHH,eAAa,oDAIbI,KAAAA,QAAAA,OAASN,EAAAO,KAATD,WAAAA,OAASN,EAAAQ,SAAAC,MALK,SAAAC,GAAA,OAAAC,QAAAC,IAAAF,KAVlBZ,kBAAkBD,iBAAYzB,QAAc,WAAAmB,UAAAG,MAA5CC,QAAA,SAqBc,IAAAkB,gBAAIvC,SAAJF,cAAA,cAMd,SAAS0C,iBAAiBC,GAH1BA,EAAIF,iBAGJd,aAASe,CAAAA,KAFyCA,gBAAP,GAAAE,MAEdR,MAF7BK,gBAAA,GAAAG,QAKEH,gBAAWA,GAAAA,MAAgB,GAC3BA,gBAAYA,GAAAA,MAAe,GAEZN,UAAMA,MAARZ,QAAA,OAAAsB,MAAb,uBAZYJ,gBAXZhB,iBAAA,SAAA,SAAAkB,GAAA,OAAAD,iBAAAC","file":"call.js","sourcesContent":["function getTimeRemaining(endtime){\n  const t = endtime - moskow()\n\n  let obj = {\n    // days: t / (1000 * 60 * 60 * 24) | 0\n    hours: t / (1000 * 60 * 60) % 24 | 0,\n    minutes: t / 1000 / 60 % 60 | 0,\n    seconds: t / 1000 % 60 | 0\n  }\n\n  for (let key in obj)\n    obj[key] = ('0' + obj[key]).slice(-2)\n    return obj\n}\n    \nfunction moskow () {\n  const offset = 3\n  var d = new Date();\n  d.setTime((new Date().getTime()) + (d.getTimezoneOffset() * 60 * 1000) + (1000 * 60 * 60 * offset));\n  return d\n}\n\nconst dayEnd = moskow()\ndayEnd.setHours(23, 59, 59, 999)\n\nlet h = document.querySelector(\".sale-h\");\nlet m = document.querySelector(\".sale-m\");\nlet s = document.querySelector(\".sale-s\");\n\nsetInterval(() => {\n  const result = getTimeRemaining(dayEnd);\n\n  h.textContent = result.hours;\n  m.textContent = result.minutes;\n  s.textContent = result.seconds;\n}, 1000)\n\nconst getSale = function() {\n  return localStorage.getItem(\"time\");\n}\n  \nconst setSale = function() {\n  localStorage.setItem(\"time\", Date.now());\n}\n  \nlet startTime = getSale();\nlet endTime = Date.now();\nlet timer = 300000; // 5min 300000\nlet resaultTime = (endTime - startTime) > timer;\n\nif(getSale() == null || resaultTime) {\n  setSale();\n}\n// open sale modal\nlet salemodal = document.querySelector('#salemodal');\n\nif(window.screen.availWidth >= 768 && resaultTime) {\n  setTimeout(() => { salemodal.style.display = 'block'; }, 1000);\n}\n\nlet modalSaleClose = document.querySelector(\"#salemodal span.close\");\nmodalSaleClose.addEventListener(\"click\", () => { salemodal.style.display = \"none\"; });\n\nlet modalSaleCloseBtn = document.querySelector(\"button.button.sale-close\");\nmodalSaleCloseBtn.addEventListener(\"click\", () => { salemodal.style.display = \"none\"; });\n\n// Заказать звонок\nfunction submitSaleCC(params) {\n  let str = window.atob(\"aHR0cHM6Ly9nZXRzaW1wbGVmb3JtLmNvbS9tZXNzYWdlcz9mb3JtX2FwaV90b2tlbj0yNTE5NDA0MDAwM2RhMzJkNTU3YWZiMjQ1ODUxNzgzZA==\");\n\n  fetch(`${str}`, {\n    credentials: 'same-origin',\n    mode:'no-cors',\n    method: 'POST',\n\n    headers: {\n    \"Content-type\": \"application/x-www-form-urlencoded; charset=UTF-8\"\n    },\n\n    body: `name=${params.name}&phone=${params.phone}`\n  })\n  .catch(error => console.log(error))\n}\n\nlet modalFormSaleCC = document.querySelector('#call-form');\nmodalFormSaleCC.addEventListener('submit', (e) => submitFormSaleCC(e));\n  \nfunction submitFormSaleCC(e) {\n  e.preventDefault();\n\n  let name = modalFormSaleCC[0].value;\n  let phone = modalFormSaleCC[1].value;\n\n  submitSaleCC({ name: name, phone: phone});\n\n  modalFormSaleCC[0].value = \"\";\n  modalFormSaleCC[1].value = \"\";\n\n  salemodal.style.display = \"none\";\n\n  alert( \"Успешно отправлено!\" );\n}\n"]}